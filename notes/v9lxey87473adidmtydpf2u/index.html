<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>TDD</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Notes on Test Driven Development"/><meta property="og:title" content="TDD"/><meta property="og:description" content="Notes on Test Driven Development"/><meta property="og:url" content="https://rperez2021.github.io/DevNotes/notes/v9lxey87473adidmtydpf2u/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="4/8/2022"/><meta property="article:modified_time" content="4/11/2022"/><link rel="canonical" href="https://rperez2021.github.io/DevNotes/notes/v9lxey87473adidmtydpf2u/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/DevNotes/_next/static/css/eed8bf81abfd52c3.css" as="style"/><link rel="stylesheet" href="/DevNotes/_next/static/css/eed8bf81abfd52c3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/DevNotes/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/DevNotes/_next/static/chunks/webpack-0c999df4017467fc.js" defer=""></script><script src="/DevNotes/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/DevNotes/_next/static/chunks/main-772151c4b16ecf54.js" defer=""></script><script src="/DevNotes/_next/static/chunks/pages/_app-12b82b1567467517.js" defer=""></script><script src="/DevNotes/_next/static/chunks/826-e0e455fb469c158f.js" defer=""></script><script src="/DevNotes/_next/static/chunks/986-737e5da213076068.js" defer=""></script><script src="/DevNotes/_next/static/chunks/pages/notes/%5Bid%5D-00dd1421f3ce3a3e.js" defer=""></script><script src="/DevNotes/_next/static/ZngNBAAOWdGj2M_dMvVk6/_buildManifest.js" defer=""></script><script src="/DevNotes/_next/static/ZngNBAAOWdGj2M_dMvVk6/_ssgManifest.js" defer=""></script><script src="/DevNotes/_next/static/ZngNBAAOWdGj2M_dMvVk6/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="tdd"><a aria-hidden="true" class="anchor-heading" href="#tdd"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>TDD</h1>
<h2 id="general-info"><a aria-hidden="true" class="anchor-heading" href="#general-info"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>General Info</h2>
<p><strong>Test-driven development (TDD)</strong>, is a new age evolutionary approach to development which emphasizes test-first development. Here you write a test before you write just enough production code to fulfill that test and then go on to refactor the code. The primary goal of TDD is specification and not validation (Martin, Newkirk, and Kess 2003).  In other words, TDD is one way to think through your requirements or design before your write your functional code (implying that TDD is both an important agile requirements and agile design technique). Another view is that TDD is a programming technique. As Ron Jeffries likes to say, the goal of TDD is to write clean code that works.</p>
<p>The first step is to quickly add a test, basically just enough test for your code to fail. Next you run your tests, often the complete test suite although for sake of speed you may decide to run only a subset, to ensure that the new test does in fact fail. You then update your functional code to make it pass the new tests. The fourth step is to run your tests again. If they fail you need to update your functional code and retest until the tests pass.</p>
<p><img src="/DevNotes/assets/tddSteps.jpg" alt="TDD Steps"></p>
<h3 id="why-should-developers-care-about-automated-unit-tests"><a aria-hidden="true" class="anchor-heading" href="#why-should-developers-care-about-automated-unit-tests"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Why should developers care about automated unit tests?</h3>
<ul>
<li>Keeps you out of the (time hungry) debugger!</li>
<li>Reduces bugs in new features and in existing features</li>
<li>Reduces the cost of change</li>
<li>Improves design</li>
<li>Encourages refactoring</li>
<li>Builds a safety net to defend against other programmers</li>
<li>Is fun</li>
<li>Forces you to slow down and think</li>
<li>Speeds up development by eliminating waste</li>
<li>Reduces fear</li>
</ul>
<h3 id="how-does-tdd-take-development-to-the-next-level"><a aria-hidden="true" class="anchor-heading" href="#how-does-tdd-take-development-to-the-next-level"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>How does TDD take development to the next level?</h3>
<ul>
<li>Improves productivity by
<ul>
<li>minimizing time spent debugging</li>
<li>reduces the need for manual (monkey) checking by developers and tester</li>
<li>helping developers to maintain focus</li>
<li>reduce <strong>wastage</strong>: hand overs</li>
</ul>
</li>
<li>Improves communication</li>
<li>Creating living, up-to-date specification</li>
<li>Communicate design decisions</li>
<li>Learning: listen to your code</li>
<li>Baby steps: slow down and think</li>
<li>Improves confidence</li>
<li>Testable code by design + safety net</li>
<li>Loosely-coupled design</li>
<li>Refactoring</li>
</ul>
<p>In summary, the importance of TDD cannot be overemphasized. TDD means less bugs, higher quality software, and a razor focus, but it can slow development down and the test suites can be tedious to manage and maintain. All in all, it is a recommended approach as the Pros far outweighs the Cons.</p>
<h3 id="tdd-should-lead-to-better-design"><a aria-hidden="true" class="anchor-heading" href="#tdd-should-lead-to-better-design"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>TDD should lead to better design</h3>
<p>The process of learning effective TDD is the process of learning how to build more modular applications. TDD tends to have a simplifying effect on code, not a complicating effect. If you find that your code gets harder to read or maintain when you make it more testable, or you have to bloat your code with dependency injection boilerplate, you’re doing TDD wrong.</p>
<ol>
<li>You can write decoupled code without dependency injection, and</li>
<li>Maximizing code coverage brings diminishing returns — the closer you get to 100% coverage, the more you have to complicate your application code to get even closer, which can subvert the important goal of reducing bugs in your application.</li>
</ol>
<p>More complex code is often accompanied by more cluttered code. You want to produce uncluttered code for the same reasons you want to keep your house tidy:</p>
<ul>
<li>More clutter leads to more convenient places for bugs to hide, which leads to more bugs, and</li>
<li>It’s easier to find what you’re looking for when there’s less clutter to get lost in.</li>
</ul>
<h3 id="code-smells"><a aria-hidden="true" class="anchor-heading" href="#code-smells"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Code Smells</h3>
<blockquote>
<p>“A code smell is a surface indication that usually corresponds to a deeper > problem in the system.” ~ Martin Fowler</p>
</blockquote>
<h3 id="what-is-a-mock"><a aria-hidden="true" class="anchor-heading" href="#what-is-a-mock"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>What is a Mock</h3>
<p>A mock is a test double that stands in for real implementation code during the unit testing process. A mock is capable of producing assertions about how it was manipulated by the test subject during the test run. If your test double produces assertions, it’s a mock in the specific sense of the word.</p>
<p>The term “mock” is also used more generally to refer to the use of any kind of test double.</p>
<h3 id="what-is-a-unit-test"><a aria-hidden="true" class="anchor-heading" href="#what-is-a-unit-test"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>What is a unit test?</h3>
<p>Unit tests test individual units (modules, functions, classes) in isolation from the rest of the program.</p>
<p>Contrast unit tests with integration tests, which test integrations between two or more units, and functional tests, which test the application from the point of view of the user, including complete user interaction workflows from simulated UI manipulation, to data layer updates, and back to the user output (e.g., the on-screen representation of the app).</p>
<p>Functional tests are a subset of integration tests, because they test all of the units of an application, integrated in the context of the running application.</p>
<p>In general, units are tested using only the public interface of the unit (aka “public API” or “surface area”). This is referred to as black box testing. Black box testing leads to less brittle tests, because the implementation details of a unit tend to change more over time than the public API of the unit. If you use white box testing, where tests are aware of implementation details, any change to the implementation details could break the test, even if the public API continues to function as expected. In other words, white-box testing leads to wasted rework.</p>
<h3 id="test-coverage"><a aria-hidden="true" class="anchor-heading" href="#test-coverage"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Test Coverage</h3>
<p>Code coverage refers to the amount of code covered by test cases. Coverage reports can be created by instrumenting the code and recording which lines were exercised during a test run. In general, we try to produce a high level of coverage, but code coverage starts to deliver diminishing returns as it gets closer to 100%.</p>
<p>What most people don’t realize is that there are two kinds of coverage:</p>
<ol>
<li>Code coverage: how much of the code is exercised, and</li>
<li>Case coverage: how many of the use-cases are covered by the test suites</li>
</ol>
<p>Because use-cases may involve the environment, multiple units, users, and networking conditions, it is impossible to cover all required use-cases with a test suite that only contains unit tests. Unit tests by definition test units in isolation, not in integration, meaning that a test suite containing only unit tests will always have close to 0% case coverage for integration and functionaluse-case scenarios</p>
<p>100% code coverage does not guarantee 100% case coverage.</p>
<p>Developers targeting 100% code coverage are chasing the wrong metric.</p>
<h3 id="tight-coupling"><a aria-hidden="true" class="anchor-heading" href="#tight-coupling"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Tight Coupling</h3>
<p>The need to mock in order to achieve unit isolation for the purpose of unit tests is caused by coupling between units. Tight coupling makes code more rigid and brittle: more likely to break when changes are required. In general, less coupling is desirable for its own sake because it makes code easier to extend and maintain. The fact that it also makes testing easier by eliminating the need for mocks is just icing on the cake.</p>
<p>From this we can deduce that if we’re mocking something, there may be an opportunity to make our code more flexible by reducing the coupling between units. Once that’s done, you won’t need the mocks anymore.</p>
<p>Coupling is the degree to which a unit of code (module, function, class, etc…) depends upon other units of code. Tight coupling, or a high degree of coupling, refers to how likely a unit is to break when changes are made to its dependencies. In other words, the tighter the coupling, the harder it is to maintain or extend the application. Loose coupling reduces the complexity of fixing bugs and adapting the application to new use-cases.</p>
<p>Coupling takes different forms:</p>
<ul>
<li><strong>Subclass coupling</strong>: Subclasses are dependent on the implementation and entire hierarchy of the parent class: the tightest form of coupling available in OO design.</li>
<li><strong>Control dependencies</strong>: Code that controls its dependencies by telling them what to do, e.g., passing method names, etc… If the control API of the dependency changes, the dependent code will break.</li>
<li><strong>Mutable state dependencies</strong>: Code that shares mutable state with other code, e.g., can change properties on a shared object. If relative timing of mutations change, it could break dependent code. If timing is nondeterministic, it may be impossible to achieve program correctness without a complete overhaul of all dependent units: e.g., there may be an irreparable tangle of race conditions. Fixing one bug could cause others to appear in other dependent units.</li>
<li><strong>State shape dependencies</strong>: Code that shares data structures with other code, and only uses a subset of the structure. If the shape of the shared structure changes, it could break the dependent code.</li>
<li><strong>Event/message coupling</strong>: Code that communicates with other units via message passing, events, etc…</li>
</ul>
<h4 id="causes-of-tight-coupling"><a aria-hidden="true" class="anchor-heading" href="#causes-of-tight-coupling"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Causes of Tight Coupling</h4>
<ul>
<li>Mutation vs immutability</li>
<li>Side-Effects vs purity/isolated side-effects</li>
<li>Responsibility overload vs Do One Thing (DOT)</li>
<li>Procedural instructions vs describing structure</li>
<li>Class Inheritance vs composition</li>
</ul>
<p>Imperative and object-oriented code is more susceptible to tight coupling than functional code. That doesn’t mean that programming in a functional style makes your code immune to tight coupling, but functional code uses pure functions as the elemental unit of composition, and pure functions are less vulnerable to tight coupling by nature.</p>
<h4 id="how-to-pure-functions-reduce-coupling"><a aria-hidden="true" class="anchor-heading" href="#how-to-pure-functions-reduce-coupling"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>How to Pure Functions Reduce Coupling?</h4>
<p>Pure functions:</p>
<ul>
<li>Given the same input, always return the same output, and</li>
<li>Produce no side-effects</li>
</ul>
<p>They reduce coupling by:</p>
<ul>
<li><strong>Immutability</strong>: Pure functions don’t mutate existing values. They return new ones, instead.</li>
<li><strong>No side effects</strong>: The only observable effect of a pure function is its return value, so there’s no chance for it to interfere with the operation of other functions that may be observing external state such as the screen, the DOM, the console, standard out, the network, or the disk.</li>
<li><strong>Do one thing</strong>: Pure functions do one thing: Map some input to some corresponding output, avoiding the responsibility overload that tends to plague object and class-based code.</li>
<li><strong>Structure, not instructions</strong>: Pure functions can be safely memoized, meaning that, if the system had infinite memory, any pure function could be replaced with a lookup table that uses the function’s input as an index to retrieve a corresponding value from the table. In other words, pure functions describe structural relationships between data, not instructions for the computer to follow, so two different sets of conflicting instructions running at the same time can’t step on each other’s toes and cause problems.</li>
</ul>
<h4 id="how-to-remove-coupling"><a aria-hidden="true" class="anchor-heading" href="#how-to-remove-coupling"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>How to Remove Coupling</h4>
<p>To remove coupling, we first need a better understanding of where coupling dependencies come from. Here are the main sources, roughly in order of how tight the coupling is:</p>
<p>Tight coupling:</p>
<ul>
<li>Class inheritance (coupling is multiplied by each layer of inheritance and each descendant class)</li>
<li>Global variables</li>
<li>Other mutable global state (browser DOM, shared storage, network, etc…)</li>
<li>Module imports with side-effects</li>
<li>Implicit dependencies from compositions, e.g., const enhancedWidgetFactory = compose(eventEmitter, widgetFactory, enhancements); where widgetFactory depends on eventEmitter</li>
<li>Dependency injection containers</li>
<li>Dependency injection parameters</li>
<li>Control parameters (an outside unit is controlling the subject unit by telling it what to do)</li>
<li>Mutable parameters</li>
</ul>
<p>Loose coupling:</p>
<ul>
<li>Module imports without side-effects (in black box testing, not all imports need isolating)</li>
<li>Message passing/pubsub</li>
<li>Immutable parameters (can still cause shared dependencies on state shape)</li>
</ul>
<p>Ironically, most of the sources of coupling are mechanisms originally designed to reduce coupling. That makes sense, because in order to recompose our smaller problem solutions into a complete application, they need to integrate and communicate somehow. There are good ways, and bad ways. The sources that cause tight coupling should be avoided whenever it’s practical to do so. The loose coupling options are generally desirable in a healthy application.</p>
<p>You might be confused that I classified dependency injection containers and dependency injection parameters in the “tight coupling” group, when so many books and blog post categorize them as “loose coupling”. Coupling is not binary. It’s a gradient scale. That means that any grouping is going to be somewhat subjective and arbitrary.</p>
<p>Can the unit be tested without mocking dependencies? If it can’t, it’s tightly coupled to the mocked dependencies.</p>
<p>The more dependencies your unit has, the more likely it is that there may be problematic coupling. Now that we understand how coupling happens, what can we do about it?</p>
<ol>
<li>Use pure functions as the atomic unit of composition, as opposed to classes, imperative procedures, or mutating functions</li>
<li>Isolate side-effects from the rest of your program logic. That means don’t mix logic with I/O (including network I/O, rendering UI, logging, etc…)</li>
<li>Remove dependent logic from imperative compositions so that they can become declarative compositions which don’t need their own unit tests. If there’s no logic, there’s nothing meaningful to unit test</li>
</ol>
<p>That means that the code you use to set up network requests and request handlers won’t need unit tests. Use integration tests for those, instead.</p>
<p>That bears repeating:</p>
<blockquote>
<p>Don’t unit test I/O.
I/O is for integrations. Use integration tests, instead.</p>
</blockquote>
<p>It’s perfectly OK to mock and fake for integration tests.</p>
<h5 id="use-pure-functions"><a aria-hidden="true" class="anchor-heading" href="#use-pure-functions"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Use pure functions</h5>
<p>Using pure functions takes a little practice, and without that practice, it’s not always clear how to write a pure function to do what you want to do. Pure functions can’t directly mutate global variables, the arguments passed into them, the network, the disk, or the screen. All they can do is return a value.</p>
<p>If you’re passed an array or an object, and you want to return a changed version of that object, you can’t just make the changes to the object and return it. You have to create a new copy of the object with the required changes. You can do that with the array accessor methods (e.g, concat, filter, map, reduce, slice), Object.assign(), using a new empty object as the target, or the array or object spread syntax. </p>
<p>For example:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Not pure</span>
<span class="token keyword">const</span> <span class="token function-variable function">signInUser</span> <span class="token operator">=</span> <span class="token parameter">user</span> <span class="token arrow operator">=></span> user<span class="token punctuation">.</span><span class="token property-access">isSignedIn</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Foo'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isSignedIn</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// Foo was mutated</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>
  <span class="token function">signInUser</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// true</span>
  foo              <span class="token comment">// { name: "Foo", isSignedIn: true }</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>vs…</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Pure</span>
<span class="token keyword">const</span> <span class="token function-variable function">signInUser</span> <span class="token operator">=</span> <span class="token parameter">user</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token spread operator">...</span>user<span class="token punctuation">,</span> <span class="token literal-property property">isSignedIn</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Foo'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isSignedIn</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// Foo was not mutated</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>
  <span class="token function">signInUser</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// { name: "Foo", isSignedIn: true }</span>
  foo              <span class="token comment">// { name: "Foo", isSignedIn: false }</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>You can use that trick to make React components render faster if you have a complex state tree that you may not need to traverse in depth with each render pass. Inherit from <code>PureComponent</code> and it implements <code>shouldComponentUpdate()</code> with a shallow prop and state comparison. When it detects identity equality, it knows that nothing has changed in that part of the state tree and it can move on without a deep state traversal.</p>
<p>Pure functions can also be memoized, meaning that you don’t have to build the whole object again if you’ve seen the same inputs before. You can trade computation complexity for memory and store pre-calculated values in a lookup table. For computationally expensive processes which don’t require unbounded memory, this may be a great optimization strategy.</p>
<p>Another property of pure functions is that, because they have no side-effects, it’s safe to distribute complex computations over large clusters of processors, using a divide-and-conquer strategy. This tactic is often employed to process images, videos, or audio frames using massively parallel GPUs originally designed for graphics, but now commonly used for lots of other purposes, like scientific computing.</p>
<p>In other words, mutation isn’t always faster, and it is often orders of magnitude slower because it takes a micro-optimization at the expense of macro-optimizations.</p>
<h5 id="isolate-side-effects-from-the-rest-of-your-program-logic"><a aria-hidden="true" class="anchor-heading" href="#isolate-side-effects-from-the-rest-of-your-program-logic"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Isolate side-effects from the rest of your program logic</h5>
<p>There are several strategies that can help you isolate side-effects from the rest of your program logic. Here are some of them:</p>
<ul>
<li>Use pub/sub to decouple I/O from views and program logic. Rather than directly triggering side-effects in UI views or program logic, emit an event or action object describing an event or intent.</li>
<li>Isolate logic from I/O e.g., compose functions which return promises using <code>asyncPipe()</code>.</li>
<li>Use objects that represent future computations rather than directly triggering computation with I/O, e.g., <code>call()</code> from <code>redux-saga</code> doesn't actually call a function. Instead, it returns an object with a reference to a function and its arguments, and the saga middleware calls it for you. That makes <code>call()</code> and all the functions that use it <em>pure functions</em>, which are easy to unit test with no mocking required.</li>
</ul>
<h5 id="use-pubsub"><a aria-hidden="true" class="anchor-heading" href="#use-pubsub"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Use Pub/Sub</h5>
<p>Pub/sub is short for the publish/subscribe pattern. In the publish/subscribe pattern, units don’t directly call each other. Instead, they publish messages that other units (subscribers) can listen to. Publishers don’t know what (if any) units will subscribe, and subscribers don’t know what (if any) publishers will publish.</p>
<p>Pub/sub is baked into the Document Object Model (DOM). Any component in your application can listen to events dispatched from DOM elements, such as mouse movements, clicks, scroll events, keystrokes, and so on. Back when everyone built web apps with jQuery, it was common to jQuery custom events to turn the DOM into a pub/sub event bus to decouple view rendering concerns from state logic.</p>
<p>Pub/sub is also baked into Redux. In Redux, you create a global model for application state (called the store). Instead of directly manipulating models, views and I/O handlers dispatch action objects to the store. An action object has a special key, called <code>type</code> which various reducers can listen for and respond to. Additionally, Redux supports middleware, which can also listen for and respond to specific action types. This way, your views don't need to know anything about how your application state is handled, and the state logic doesn't need to know anything about the views.</p>
<p>It also makes it trivial to patch into the dispatcher via middleware and trigger cross-cutting concerns, such as action logging/analytics, syncing state with storage or the server, and patching in realtime communication features with servers and network peers.</p>
<h5 id="isolate-logic-from-io"><a aria-hidden="true" class="anchor-heading" href="#isolate-logic-from-io"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Isolate logic from I/O</h5>
<p>Sometimes you can use monad compositions (like promises) to eliminate dependent logic from your compositions. For example, the following function contains logic that you can’t unit test without mocking all of the async functions:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">uploadFiles</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>user<span class="token punctuation">,</span> folder<span class="token punctuation">,</span> files<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dbUser <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">readUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> folderInfo <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">getFolderInfo</span><span class="token punctuation">(</span>folder<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword control-flow">await</span> <span class="token function">haveWriteAccess</span><span class="token punctuation">(</span><span class="token punctuation">{</span>dbUser<span class="token punctuation">,</span> folderInfo<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token function">uploadToFolder</span><span class="token punctuation">(</span><span class="token punctuation">{</span>dbUser<span class="token punctuation">,</span> folderInfo<span class="token punctuation">,</span> files <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"No write access to that folder"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Remember</strong>: Logic and I/O are separate concerns.
Logic is thinking. Effects are actions. Think before you act!</p>
<h2 id="sources"><a aria-hidden="true" class="anchor-heading" href="#sources"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Sources</h2>
<p>Most of this info was copied from this <a href="https://medium.com/javascript-scene/mocking-is-a-code-smell-944a70c90a6a">Medium Article by Eric Elliot</a></p></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#general-info" title="General Info">General Info</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#why-should-developers-care-about-automated-unit-tests" title="Why should developers care about automated unit tests?">Why should developers care about automated unit tests?</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#how-does-tdd-take-development-to-the-next-level" title="How does TDD take development to the next level?">How does TDD take development to the next level?</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#tdd-should-lead-to-better-design" title="TDD should lead to better design">TDD should lead to better design</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#code-smells" title="Code Smells">Code Smells</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#what-is-a-mock" title="What is a Mock">What is a Mock</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#what-is-a-unit-test" title="What is a unit test?">What is a unit test?</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#test-coverage" title="Test Coverage">Test Coverage</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#tight-coupling" title="Tight Coupling">Tight Coupling</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#causes-of-tight-coupling" title="Causes of Tight Coupling">Causes of Tight Coupling</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#how-to-pure-functions-reduce-coupling" title="How to Pure Functions Reduce Coupling?">How to Pure Functions Reduce Coupling?</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#how-to-remove-coupling" title="How to Remove Coupling">How to Remove Coupling</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#use-pure-functions" title="Use pure functions">Use pure functions</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#isolate-side-effects-from-the-rest-of-your-program-logic" title="Isolate side-effects from the rest of your program logic">Isolate side-effects from the rest of your program logic</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#use-pubsub" title="Use Pub/Sub">Use Pub/Sub</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#isolate-logic-from-io" title="Isolate logic from I/O">Isolate logic from I/O</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sources" title="Sources">Sources</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"v9lxey87473adidmtydpf2u","title":"TDD","desc":"Notes on Test Driven Development","updated":1649716206418,"created":1649381265266,"custom":{},"fname":"devnotes.javascript.tdd","type":"note","vault":{"fsPath":"vault"},"contentHash":"fb179c878e2e0560976c8c3241e18338","links":[],"anchors":{"general-info":{"type":"header","text":"General Info","value":"general-info","line":7,"column":0,"depth":2},"why-should-developers-care-about-automated-unit-tests":{"type":"header","text":"Why should developers care about automated unit tests?","value":"why-should-developers-care-about-automated-unit-tests","line":15,"column":0,"depth":3},"how-does-tdd-take-development-to-the-next-level":{"type":"header","text":"How does TDD take development to the next level?","value":"how-does-tdd-take-development-to-the-next-level","line":28,"column":0,"depth":3},"tdd-should-lead-to-better-design":{"type":"header","text":"TDD should lead to better design","value":"tdd-should-lead-to-better-design","line":47,"column":0,"depth":3},"code-smells":{"type":"header","text":"Code Smells","value":"code-smells","line":59,"column":0,"depth":3},"what-is-a-mock":{"type":"header","text":"What is a Mock","value":"what-is-a-mock","line":63,"column":0,"depth":3},"what-is-a-unit-test":{"type":"header","text":"What is a unit test?","value":"what-is-a-unit-test","line":69,"column":0,"depth":3},"test-coverage":{"type":"header","text":"Test Coverage","value":"test-coverage","line":79,"column":0,"depth":3},"tight-coupling":{"type":"header","text":"Tight Coupling","value":"tight-coupling","line":94,"column":0,"depth":3},"causes-of-tight-coupling":{"type":"header","text":"Causes of Tight Coupling","value":"causes-of-tight-coupling","line":110,"column":0,"depth":4},"how-to-pure-functions-reduce-coupling":{"type":"header","text":"How to Pure Functions Reduce Coupling?","value":"how-to-pure-functions-reduce-coupling","line":120,"column":0,"depth":4},"how-to-remove-coupling":{"type":"header","text":"How to Remove Coupling","value":"how-to-remove-coupling","line":134,"column":0,"depth":4},"use-pure-functions":{"type":"header","text":"Use pure functions","value":"use-pure-functions","line":177,"column":0,"depth":5},"isolate-side-effects-from-the-rest-of-your-program-logic":{"type":"header","text":"Isolate side-effects from the rest of your program logic","value":"isolate-side-effects-from-the-rest-of-your-program-logic","line":223,"column":0,"depth":5},"use-pubsub":{"type":"header","text":"Use Pub/Sub","value":"use-pubsub","line":231,"column":0,"depth":5},"isolate-logic-from-io":{"type":"header","text":"Isolate logic from I/O","value":"isolate-logic-from-io","line":241,"column":0,"depth":5},"sources":{"type":"header","text":"Sources","value":"sources","line":260,"column":0,"depth":2}},"children":[],"parent":"cOSLT6ncEiScjLx1bEQKH","data":{}},"body":"\u003ch1 id=\"tdd\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#tdd\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTDD\u003c/h1\u003e\n\u003ch2 id=\"general-info\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#general-info\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eGeneral Info\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eTest-driven development (TDD)\u003c/strong\u003e, is a new age evolutionary approach to development which emphasizes test-first development. Here you write a test before you write just enough production code to fulfill that test and then go on to refactor the code. The primary goal of TDD is specification and not validation (Martin, Newkirk, and Kess 2003).  In other words, TDD is one way to think through your requirements or design before your write your functional code (implying that TDD is both an important agile requirements and agile design technique). Another view is that TDD is a programming technique. As Ron Jeffries likes to say, the goal of TDD is to write clean code that works.\u003c/p\u003e\n\u003cp\u003eThe first step is to quickly add a test, basically just enough test for your code to fail. Next you run your tests, often the complete test suite although for sake of speed you may decide to run only a subset, to ensure that the new test does in fact fail. You then update your functional code to make it pass the new tests. The fourth step is to run your tests again. If they fail you need to update your functional code and retest until the tests pass.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/DevNotes/assets/tddSteps.jpg\" alt=\"TDD Steps\"\u003e\u003c/p\u003e\n\u003ch3 id=\"why-should-developers-care-about-automated-unit-tests\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#why-should-developers-care-about-automated-unit-tests\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eWhy should developers care about automated unit tests?\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eKeeps you out of the (time hungry) debugger!\u003c/li\u003e\n\u003cli\u003eReduces bugs in new features and in existing features\u003c/li\u003e\n\u003cli\u003eReduces the cost of change\u003c/li\u003e\n\u003cli\u003eImproves design\u003c/li\u003e\n\u003cli\u003eEncourages refactoring\u003c/li\u003e\n\u003cli\u003eBuilds a safety net to defend against other programmers\u003c/li\u003e\n\u003cli\u003eIs fun\u003c/li\u003e\n\u003cli\u003eForces you to slow down and think\u003c/li\u003e\n\u003cli\u003eSpeeds up development by eliminating waste\u003c/li\u003e\n\u003cli\u003eReduces fear\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"how-does-tdd-take-development-to-the-next-level\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#how-does-tdd-take-development-to-the-next-level\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eHow does TDD take development to the next level?\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eImproves productivity by\n\u003cul\u003e\n\u003cli\u003eminimizing time spent debugging\u003c/li\u003e\n\u003cli\u003ereduces the need for manual (monkey) checking by developers and tester\u003c/li\u003e\n\u003cli\u003ehelping developers to maintain focus\u003c/li\u003e\n\u003cli\u003ereduce \u003cstrong\u003ewastage\u003c/strong\u003e: hand overs\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eImproves communication\u003c/li\u003e\n\u003cli\u003eCreating living, up-to-date specification\u003c/li\u003e\n\u003cli\u003eCommunicate design decisions\u003c/li\u003e\n\u003cli\u003eLearning: listen to your code\u003c/li\u003e\n\u003cli\u003eBaby steps: slow down and think\u003c/li\u003e\n\u003cli\u003eImproves confidence\u003c/li\u003e\n\u003cli\u003eTestable code by design + safety net\u003c/li\u003e\n\u003cli\u003eLoosely-coupled design\u003c/li\u003e\n\u003cli\u003eRefactoring\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn summary, the importance of TDD cannot be overemphasized. TDD means less bugs, higher quality software, and a razor focus, but it can slow development down and the test suites can be tedious to manage and maintain. All in all, it is a recommended approach as the Pros far outweighs the Cons.\u003c/p\u003e\n\u003ch3 id=\"tdd-should-lead-to-better-design\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#tdd-should-lead-to-better-design\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTDD should lead to better design\u003c/h3\u003e\n\u003cp\u003eThe process of learning effective TDD is the process of learning how to build more modular applications. TDD tends to have a simplifying effect on code, not a complicating effect. If you find that your code gets harder to read or maintain when you make it more testable, or you have to bloat your code with dependency injection boilerplate, you’re doing TDD wrong.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eYou can write decoupled code without dependency injection, and\u003c/li\u003e\n\u003cli\u003eMaximizing code coverage brings diminishing returns — the closer you get to 100% coverage, the more you have to complicate your application code to get even closer, which can subvert the important goal of reducing bugs in your application.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eMore complex code is often accompanied by more cluttered code. You want to produce uncluttered code for the same reasons you want to keep your house tidy:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMore clutter leads to more convenient places for bugs to hide, which leads to more bugs, and\u003c/li\u003e\n\u003cli\u003eIt’s easier to find what you’re looking for when there’s less clutter to get lost in.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-smells\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#code-smells\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eCode Smells\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e“A code smell is a surface indication that usually corresponds to a deeper \u003e problem in the system.” ~ Martin Fowler\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"what-is-a-mock\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#what-is-a-mock\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eWhat is a Mock\u003c/h3\u003e\n\u003cp\u003eA mock is a test double that stands in for real implementation code during the unit testing process. A mock is capable of producing assertions about how it was manipulated by the test subject during the test run. If your test double produces assertions, it’s a mock in the specific sense of the word.\u003c/p\u003e\n\u003cp\u003eThe term “mock” is also used more generally to refer to the use of any kind of test double.\u003c/p\u003e\n\u003ch3 id=\"what-is-a-unit-test\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#what-is-a-unit-test\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eWhat is a unit test?\u003c/h3\u003e\n\u003cp\u003eUnit tests test individual units (modules, functions, classes) in isolation from the rest of the program.\u003c/p\u003e\n\u003cp\u003eContrast unit tests with integration tests, which test integrations between two or more units, and functional tests, which test the application from the point of view of the user, including complete user interaction workflows from simulated UI manipulation, to data layer updates, and back to the user output (e.g., the on-screen representation of the app).\u003c/p\u003e\n\u003cp\u003eFunctional tests are a subset of integration tests, because they test all of the units of an application, integrated in the context of the running application.\u003c/p\u003e\n\u003cp\u003eIn general, units are tested using only the public interface of the unit (aka “public API” or “surface area”). This is referred to as black box testing. Black box testing leads to less brittle tests, because the implementation details of a unit tend to change more over time than the public API of the unit. If you use white box testing, where tests are aware of implementation details, any change to the implementation details could break the test, even if the public API continues to function as expected. In other words, white-box testing leads to wasted rework.\u003c/p\u003e\n\u003ch3 id=\"test-coverage\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#test-coverage\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTest Coverage\u003c/h3\u003e\n\u003cp\u003eCode coverage refers to the amount of code covered by test cases. Coverage reports can be created by instrumenting the code and recording which lines were exercised during a test run. In general, we try to produce a high level of coverage, but code coverage starts to deliver diminishing returns as it gets closer to 100%.\u003c/p\u003e\n\u003cp\u003eWhat most people don’t realize is that there are two kinds of coverage:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eCode coverage: how much of the code is exercised, and\u003c/li\u003e\n\u003cli\u003eCase coverage: how many of the use-cases are covered by the test suites\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eBecause use-cases may involve the environment, multiple units, users, and networking conditions, it is impossible to cover all required use-cases with a test suite that only contains unit tests. Unit tests by definition test units in isolation, not in integration, meaning that a test suite containing only unit tests will always have close to 0% case coverage for integration and functionaluse-case scenarios\u003c/p\u003e\n\u003cp\u003e100% code coverage does not guarantee 100% case coverage.\u003c/p\u003e\n\u003cp\u003eDevelopers targeting 100% code coverage are chasing the wrong metric.\u003c/p\u003e\n\u003ch3 id=\"tight-coupling\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#tight-coupling\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTight Coupling\u003c/h3\u003e\n\u003cp\u003eThe need to mock in order to achieve unit isolation for the purpose of unit tests is caused by coupling between units. Tight coupling makes code more rigid and brittle: more likely to break when changes are required. In general, less coupling is desirable for its own sake because it makes code easier to extend and maintain. The fact that it also makes testing easier by eliminating the need for mocks is just icing on the cake.\u003c/p\u003e\n\u003cp\u003eFrom this we can deduce that if we’re mocking something, there may be an opportunity to make our code more flexible by reducing the coupling between units. Once that’s done, you won’t need the mocks anymore.\u003c/p\u003e\n\u003cp\u003eCoupling is the degree to which a unit of code (module, function, class, etc…) depends upon other units of code. Tight coupling, or a high degree of coupling, refers to how likely a unit is to break when changes are made to its dependencies. In other words, the tighter the coupling, the harder it is to maintain or extend the application. Loose coupling reduces the complexity of fixing bugs and adapting the application to new use-cases.\u003c/p\u003e\n\u003cp\u003eCoupling takes different forms:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eSubclass coupling\u003c/strong\u003e: Subclasses are dependent on the implementation and entire hierarchy of the parent class: the tightest form of coupling available in OO design.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eControl dependencies\u003c/strong\u003e: Code that controls its dependencies by telling them what to do, e.g., passing method names, etc… If the control API of the dependency changes, the dependent code will break.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMutable state dependencies\u003c/strong\u003e: Code that shares mutable state with other code, e.g., can change properties on a shared object. If relative timing of mutations change, it could break dependent code. If timing is nondeterministic, it may be impossible to achieve program correctness without a complete overhaul of all dependent units: e.g., there may be an irreparable tangle of race conditions. Fixing one bug could cause others to appear in other dependent units.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eState shape dependencies\u003c/strong\u003e: Code that shares data structures with other code, and only uses a subset of the structure. If the shape of the shared structure changes, it could break the dependent code.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eEvent/message coupling\u003c/strong\u003e: Code that communicates with other units via message passing, events, etc…\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"causes-of-tight-coupling\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#causes-of-tight-coupling\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eCauses of Tight Coupling\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eMutation vs immutability\u003c/li\u003e\n\u003cli\u003eSide-Effects vs purity/isolated side-effects\u003c/li\u003e\n\u003cli\u003eResponsibility overload vs Do One Thing (DOT)\u003c/li\u003e\n\u003cli\u003eProcedural instructions vs describing structure\u003c/li\u003e\n\u003cli\u003eClass Inheritance vs composition\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eImperative and object-oriented code is more susceptible to tight coupling than functional code. That doesn’t mean that programming in a functional style makes your code immune to tight coupling, but functional code uses pure functions as the elemental unit of composition, and pure functions are less vulnerable to tight coupling by nature.\u003c/p\u003e\n\u003ch4 id=\"how-to-pure-functions-reduce-coupling\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#how-to-pure-functions-reduce-coupling\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eHow to Pure Functions Reduce Coupling?\u003c/h4\u003e\n\u003cp\u003ePure functions:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGiven the same input, always return the same output, and\u003c/li\u003e\n\u003cli\u003eProduce no side-effects\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThey reduce coupling by:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eImmutability\u003c/strong\u003e: Pure functions don’t mutate existing values. They return new ones, instead.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eNo side effects\u003c/strong\u003e: The only observable effect of a pure function is its return value, so there’s no chance for it to interfere with the operation of other functions that may be observing external state such as the screen, the DOM, the console, standard out, the network, or the disk.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDo one thing\u003c/strong\u003e: Pure functions do one thing: Map some input to some corresponding output, avoiding the responsibility overload that tends to plague object and class-based code.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eStructure, not instructions\u003c/strong\u003e: Pure functions can be safely memoized, meaning that, if the system had infinite memory, any pure function could be replaced with a lookup table that uses the function’s input as an index to retrieve a corresponding value from the table. In other words, pure functions describe structural relationships between data, not instructions for the computer to follow, so two different sets of conflicting instructions running at the same time can’t step on each other’s toes and cause problems.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"how-to-remove-coupling\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#how-to-remove-coupling\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eHow to Remove Coupling\u003c/h4\u003e\n\u003cp\u003eTo remove coupling, we first need a better understanding of where coupling dependencies come from. Here are the main sources, roughly in order of how tight the coupling is:\u003c/p\u003e\n\u003cp\u003eTight coupling:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eClass inheritance (coupling is multiplied by each layer of inheritance and each descendant class)\u003c/li\u003e\n\u003cli\u003eGlobal variables\u003c/li\u003e\n\u003cli\u003eOther mutable global state (browser DOM, shared storage, network, etc…)\u003c/li\u003e\n\u003cli\u003eModule imports with side-effects\u003c/li\u003e\n\u003cli\u003eImplicit dependencies from compositions, e.g., const enhancedWidgetFactory = compose(eventEmitter, widgetFactory, enhancements); where widgetFactory depends on eventEmitter\u003c/li\u003e\n\u003cli\u003eDependency injection containers\u003c/li\u003e\n\u003cli\u003eDependency injection parameters\u003c/li\u003e\n\u003cli\u003eControl parameters (an outside unit is controlling the subject unit by telling it what to do)\u003c/li\u003e\n\u003cli\u003eMutable parameters\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLoose coupling:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eModule imports without side-effects (in black box testing, not all imports need isolating)\u003c/li\u003e\n\u003cli\u003eMessage passing/pubsub\u003c/li\u003e\n\u003cli\u003eImmutable parameters (can still cause shared dependencies on state shape)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIronically, most of the sources of coupling are mechanisms originally designed to reduce coupling. That makes sense, because in order to recompose our smaller problem solutions into a complete application, they need to integrate and communicate somehow. There are good ways, and bad ways. The sources that cause tight coupling should be avoided whenever it’s practical to do so. The loose coupling options are generally desirable in a healthy application.\u003c/p\u003e\n\u003cp\u003eYou might be confused that I classified dependency injection containers and dependency injection parameters in the “tight coupling” group, when so many books and blog post categorize them as “loose coupling”. Coupling is not binary. It’s a gradient scale. That means that any grouping is going to be somewhat subjective and arbitrary.\u003c/p\u003e\n\u003cp\u003eCan the unit be tested without mocking dependencies? If it can’t, it’s tightly coupled to the mocked dependencies.\u003c/p\u003e\n\u003cp\u003eThe more dependencies your unit has, the more likely it is that there may be problematic coupling. Now that we understand how coupling happens, what can we do about it?\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eUse pure functions as the atomic unit of composition, as opposed to classes, imperative procedures, or mutating functions\u003c/li\u003e\n\u003cli\u003eIsolate side-effects from the rest of your program logic. That means don’t mix logic with I/O (including network I/O, rendering UI, logging, etc…)\u003c/li\u003e\n\u003cli\u003eRemove dependent logic from imperative compositions so that they can become declarative compositions which don’t need their own unit tests. If there’s no logic, there’s nothing meaningful to unit test\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThat means that the code you use to set up network requests and request handlers won’t need unit tests. Use integration tests for those, instead.\u003c/p\u003e\n\u003cp\u003eThat bears repeating:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eDon’t unit test I/O.\nI/O is for integrations. Use integration tests, instead.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIt’s perfectly OK to mock and fake for integration tests.\u003c/p\u003e\n\u003ch5 id=\"use-pure-functions\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#use-pure-functions\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eUse pure functions\u003c/h5\u003e\n\u003cp\u003eUsing pure functions takes a little practice, and without that practice, it’s not always clear how to write a pure function to do what you want to do. Pure functions can’t directly mutate global variables, the arguments passed into them, the network, the disk, or the screen. All they can do is return a value.\u003c/p\u003e\n\u003cp\u003eIf you’re passed an array or an object, and you want to return a changed version of that object, you can’t just make the changes to the object and return it. You have to create a new copy of the object with the required changes. You can do that with the array accessor methods (e.g, concat, filter, map, reduce, slice), Object.assign(), using a new empty object as the target, or the array or object spread syntax. \u003c/p\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// Not pure\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003esignInUser\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token parameter\"\u003euser\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e user\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eisSignedIn\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e foo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ename\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Foo'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003eisSignedIn\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Foo was mutated\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003esignInUser\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efoo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// true\u003c/span\u003e\n  foo              \u003cspan class=\"token comment\"\u003e// { name: \"Foo\", isSignedIn: true }\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003evs…\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// Pure\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003esignInUser\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token parameter\"\u003euser\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eisSignedIn\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e foo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ename\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Foo'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003eisSignedIn\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Foo was not mutated\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003esignInUser\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efoo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// { name: \"Foo\", isSignedIn: true }\u003c/span\u003e\n  foo              \u003cspan class=\"token comment\"\u003e// { name: \"Foo\", isSignedIn: false }\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou can use that trick to make React components render faster if you have a complex state tree that you may not need to traverse in depth with each render pass. Inherit from \u003ccode\u003ePureComponent\u003c/code\u003e and it implements \u003ccode\u003eshouldComponentUpdate()\u003c/code\u003e with a shallow prop and state comparison. When it detects identity equality, it knows that nothing has changed in that part of the state tree and it can move on without a deep state traversal.\u003c/p\u003e\n\u003cp\u003ePure functions can also be memoized, meaning that you don’t have to build the whole object again if you’ve seen the same inputs before. You can trade computation complexity for memory and store pre-calculated values in a lookup table. For computationally expensive processes which don’t require unbounded memory, this may be a great optimization strategy.\u003c/p\u003e\n\u003cp\u003eAnother property of pure functions is that, because they have no side-effects, it’s safe to distribute complex computations over large clusters of processors, using a divide-and-conquer strategy. This tactic is often employed to process images, videos, or audio frames using massively parallel GPUs originally designed for graphics, but now commonly used for lots of other purposes, like scientific computing.\u003c/p\u003e\n\u003cp\u003eIn other words, mutation isn’t always faster, and it is often orders of magnitude slower because it takes a micro-optimization at the expense of macro-optimizations.\u003c/p\u003e\n\u003ch5 id=\"isolate-side-effects-from-the-rest-of-your-program-logic\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#isolate-side-effects-from-the-rest-of-your-program-logic\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eIsolate side-effects from the rest of your program logic\u003c/h5\u003e\n\u003cp\u003eThere are several strategies that can help you isolate side-effects from the rest of your program logic. Here are some of them:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUse pub/sub to decouple I/O from views and program logic. Rather than directly triggering side-effects in UI views or program logic, emit an event or action object describing an event or intent.\u003c/li\u003e\n\u003cli\u003eIsolate logic from I/O e.g., compose functions which return promises using \u003ccode\u003easyncPipe()\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eUse objects that represent future computations rather than directly triggering computation with I/O, e.g., \u003ccode\u003ecall()\u003c/code\u003e from \u003ccode\u003eredux-saga\u003c/code\u003e doesn't actually call a function. Instead, it returns an object with a reference to a function and its arguments, and the saga middleware calls it for you. That makes \u003ccode\u003ecall()\u003c/code\u003e and all the functions that use it \u003cem\u003epure functions\u003c/em\u003e, which are easy to unit test with no mocking required.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"use-pubsub\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#use-pubsub\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eUse Pub/Sub\u003c/h5\u003e\n\u003cp\u003ePub/sub is short for the publish/subscribe pattern. In the publish/subscribe pattern, units don’t directly call each other. Instead, they publish messages that other units (subscribers) can listen to. Publishers don’t know what (if any) units will subscribe, and subscribers don’t know what (if any) publishers will publish.\u003c/p\u003e\n\u003cp\u003ePub/sub is baked into the Document Object Model (DOM). Any component in your application can listen to events dispatched from DOM elements, such as mouse movements, clicks, scroll events, keystrokes, and so on. Back when everyone built web apps with jQuery, it was common to jQuery custom events to turn the DOM into a pub/sub event bus to decouple view rendering concerns from state logic.\u003c/p\u003e\n\u003cp\u003ePub/sub is also baked into Redux. In Redux, you create a global model for application state (called the store). Instead of directly manipulating models, views and I/O handlers dispatch action objects to the store. An action object has a special key, called \u003ccode\u003etype\u003c/code\u003e which various reducers can listen for and respond to. Additionally, Redux supports middleware, which can also listen for and respond to specific action types. This way, your views don't need to know anything about how your application state is handled, and the state logic doesn't need to know anything about the views.\u003c/p\u003e\n\u003cp\u003eIt also makes it trivial to patch into the dispatcher via middleware and trigger cross-cutting concerns, such as action logging/analytics, syncing state with storage or the server, and patching in realtime communication features with servers and network peers.\u003c/p\u003e\n\u003ch5 id=\"isolate-logic-from-io\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#isolate-logic-from-io\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eIsolate logic from I/O\u003c/h5\u003e\n\u003cp\u003eSometimes you can use monad compositions (like promises) to eliminate dependent logic from your compositions. For example, the following function contains logic that you can’t unit test without mocking all of the async functions:\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003euploadFiles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e folder\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e files\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e dbUser \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003ereadUser\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e folderInfo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003egetFolderInfo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efolder\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003ehaveWriteAccess\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003edbUser\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e folderInfo\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003euploadToFolder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003edbUser\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e folderInfo\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e files \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ethrow\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"No write access to that folder\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eRemember\u003c/strong\u003e: Logic and I/O are separate concerns.\nLogic is thinking. Effects are actions. Think before you act!\u003c/p\u003e\n\u003ch2 id=\"sources\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#sources\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eSources\u003c/h2\u003e\n\u003cp\u003eMost of this info was copied from this \u003ca href=\"https://medium.com/javascript-scene/mocking-is-a-code-smell-944a70c90a6a\"\u003eMedium Article by Eric Elliot\u003c/a\u003e\u003c/p\u003e","noteIndex":{"id":"root","title":"root","desc":"","updated":1605266684036,"created":1595961348801,"stub":false,"custom":{"stub":false,"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"cf4622cd4e7841f93fb3051e6203c8e6","links":[],"anchors":{},"children":["uRNDWirv66xgHSdrPwMcw","lcTujcWsxBfPEpzP49YbQ","FTV8hEHhyid0DiEvv9gNj","ph4ta0hoi7x0vch4uoz72hn","boufkx25rro7ysodpanan5g","01u0co3RYjOM1bjpc2qIU","xt9womgr90xi5ui5nezev7b","qpngd6ap92mmahr4bh4gc47","hobifg8vvmmg17kt2z5p36a"],"parent":null,"data":{},"body":"\nThis is the root for your Dendron vault.\n\nIf you decide to publish your entire vault, it will be your landing page. You are free to customize any part of this page except the frontmatter at the top, between the `---`. \n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"dendronVersion":"0.88.0","enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":true,"enableSmartRefs":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"assetsPrefix":"/DevNotes","copyAssets":true,"siteHierarchies":["root"],"enableSiteLastModified":true,"siteRootDir":"docs","siteUrl":"https://rperez2021.github.io","enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"writeStubs":false,"seo":{"title":"Dendron","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enablePrettyLinks":true,"siteFaviconPath":"favicon.ico","siteIndex":"root","enableTaskNotes":true}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"v9lxey87473adidmtydpf2u"},"buildId":"ZngNBAAOWdGj2M_dMvVk6","assetPrefix":"/DevNotes","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>